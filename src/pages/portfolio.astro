---
import ProjectsLayout from "@layouts/ProjectsLayout.astro";
import { getCollection } from "astro:content";

const portfolioItems = await getCollection("portfolio");
---

<ProjectsLayout frontmatter={{ title: "Portfolio" }} activeNav="portfolio">
  <main class="mx-auto max-w-3xl">
    <p class="mb-6 text-skin-base">
      A selection of projects I've built for clients. Each involved taking
      ownership from architecture through deployment.
    </p>
    <div class="flex flex-col gap-6">
      {
        portfolioItems.map(({ slug, data }) => (
          <article class="hover:ring-skin-accent rounded-lg bg-skin-card px-5 pb-5 pt-3 transition-all hover:ring-2">
            <h2 class="mb-1 mt-0 text-xl font-semibold">{data.title}</h2>
            <p class="mb-2 text-sm opacity-70">
              Client:{" "}
              {data.clientUrl ? (
                <a
                  href={data.clientUrl}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="client-link"
                >
                  {data.client}
                </a>
              ) : (
                data.client
              )}
            </p>
            <p class="mb-3">{data.description}</p>
            <div class="mb-3 flex flex-wrap gap-2">
              {data.technologies.map(tech => (
                <span class="tech-tag rounded border border-skin-line px-2 py-1 text-xs">
                  {tech}
                </span>
              ))}
            </div>
            <ul class="mb-3 list-inside list-disc text-sm">
              {data.results.map(result => (
                <li>{result}</li>
              ))}
            </ul>
            <a
              href={`/portfolio/${slug}`}
              class="read-more inline-block rounded-lg bg-skin-accent px-4 py-2"
            >
              Read case study &rarr;
            </a>
          </article>
        ))
      }
    </div>
  </main>
</ProjectsLayout>

<style>
  .client-link {
    color: rgb(var(--color-accent));
    text-decoration: underline;
    text-decoration-style: dashed;
    text-underline-offset: 4px;
  }
  .client-link:hover {
    text-decoration-style: solid;
  }
  .tech-tag {
    color: rgb(var(--color-text-base));
  }
  a.read-more {
    color: #fff !important;
    text-decoration: none !important;
  }
  a.read-more:hover {
    color: #fff !important;
    text-decoration: underline !important;
    text-decoration-style: dashed !important;
    text-underline-offset: 6px;
  }
</style>
