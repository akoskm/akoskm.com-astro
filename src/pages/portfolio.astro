---
import ProjectsLayout from "@layouts/ProjectsLayout.astro";
import { getCollection } from "astro:content";

const portfolioItems = await getCollection("portfolio");
---

<ProjectsLayout frontmatter={{ title: "Portfolio" }} activeNav="portfolio">
  <main class="mx-auto max-w-3xl">
    <p class="mb-6 text-skin-base">
      A selection of projects I've built for clients. Each involved taking
      ownership from architecture through deployment.
    </p>
    <div class="flex flex-col gap-6">
      {
        portfolioItems.map(({ slug, data }) => (
          <article class="px-5 pt-3 pb-5 rounded-lg bg-skin-card transition-all hover:ring-2 hover:ring-skin-accent">
            <h2 class="text-xl font-semibold mb-1 mt-0">{data.title}</h2>
            <p class="text-sm opacity-70 mb-2">
              Client: {data.clientUrl ? (
                <a href={data.clientUrl} target="_blank" rel="noopener noreferrer" class="client-link">{data.client}</a>
              ) : data.client}
            </p>
            <p class="mb-3">{data.description}</p>
            <div class="flex flex-wrap gap-2 mb-3">
              {data.technologies.map((tech) => (
                <span class="tech-tag px-2 py-1 text-xs rounded border border-skin-line">
                  {tech}
                </span>
              ))}
            </div>
            <ul class="list-disc list-inside text-sm mb-3">
              {data.results.map((result) => (
                <li>{result}</li>
              ))}
            </ul>
            <a href={`/portfolio/${slug}`} class="read-more text-sm">
              Read case study &rarr;
            </a>
          </article>
        ))
      }
    </div>
  </main>
</ProjectsLayout>

<style>
  .client-link {
    color: rgb(var(--color-accent));
    text-decoration: underline;
    text-decoration-style: dashed;
    text-underline-offset: 4px;
  }
  .client-link:hover {
    text-decoration-style: solid;
  }
  .tech-tag {
    color: rgb(var(--color-text-base));
  }
  .read-more {
    color: rgb(var(--color-text-base));
    text-decoration: underline;
    text-decoration-style: dashed;
    text-underline-offset: 4px;
  }
  .read-more:hover {
    color: rgb(var(--color-accent));
  }
</style>
